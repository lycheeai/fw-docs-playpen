"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[580],{2624:(e,t,o)=>{o.r(t),o.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>r,toc:()=>h});var n=o(4848),i=o(8453);const s={title:"Signature Verification",displayed_sidebar:"webhooks"},a=void 0,r={id:"webhooks/signature-verification",title:"Signature Verification",description:"If you want to verify whether the request was in fact sent from Fourthwall you can do that by calculating webhook digital signature.",source:"@site/docs/webhooks/signature-verification.md",sourceDirName:"webhooks",slug:"/webhooks/signature-verification",permalink:"/webhooks/signature-verification",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{title:"Signature Verification",displayed_sidebar:"webhooks"},sidebar:"webhooks",previous:{title:"Testing",permalink:"/webhooks/testing"},next:{title:"Webhook Model",permalink:"/webhooks/webhook-model"}},c={},h=[];function d(e){const t={a:"a",code:"code",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.p,{children:"If you want to verify whether the request was in fact sent from Fourthwall you can do that by calculating webhook digital signature."}),"\n",(0,n.jsxs)(t.p,{children:["First head to ",(0,n.jsx)(t.a,{href:"https://my-shop.fourthwall.com/admin/dashboard/settings/for-developers?redirect",children:"webhook configuration panel"})," in your site settings and find the secret key value which is assigned to your shop, e.g."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.code,{children:"e3f93c7c-c92b-4b8f-a9b1-5b70e0891abc"})}),"\n",(0,n.jsx)(t.p,{children:"Each webhook request comes with X-Fourthwall-Hmac-SHA256 base64 encoded header. To verify request you need to compute the value using your secret key and entire webhook body. Once computed the value should be the same as the one sent in the header. Following is a code snippet describing how the verify function could look like in Python."}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-python",children:"import hmac\nimport hashlib\nimport base64\n\nSECRET = 'secret_value_from_your_shop_webhook_settings'\n\ndef verify_signature(data, hmac_header):\n    digest = hmac.new(SECRET.encode('utf-8'), data, digestmod=hashlib.sha256).digest()\n    computed_hmac = base64.b64encode(digest)\n\n    return hmac.compare_digest(computed_hmac, hmac_header.encode('utf-8'))\n"})}),"\n",(0,n.jsx)(t.p,{children:"You can use any programming language as long as the algorithm follows the same principles as described above."})]})}function u(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},8453:(e,t,o)=>{o.d(t,{R:()=>a,x:()=>r});var n=o(6540);const i={},s=n.createContext(i);function a(e){const t=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),n.createElement(s.Provider,{value:t},e.children)}}}]);